# 新手题库2020：程序设计基础讲座

## 第二讲：循环结构探讨

#### 先修知识点：变量与常量，表达式，条件判断，循环控制

众所周知，**循环结构**乃程序设计控制结构之重点。人类创造计算机的目的，就是代替人类去做一些重复性的低智力劳动，而循环结构恰恰满足这一特点，由此可以看出循环结构在计算机程序设计语言中的重要地位。

接下来的几章，我们将带领大家着重探讨一些典型循环结构的应用，以及循环结构的高效便携方式。以下几个专题是我在长期（其实就一两年）编程实践中总结出来的经验，供大家参考。

综合来看，在我们学习**数组**这一个重要数据结构之前，我们能用循环解决的问题十分有限，本章主要探讨的问题不涉及到**数组**这个数据结构，均是使用非常有限的变量个数就能解决的问题。

本章，我们将讨论3个较为重要的常用循环结构：

> **1. 规定个数的循环结构**
>
> **2. 与整数位数有关的循环结构**
>
> **3. 循环与迭代结构**

本次的解说将分别阐释这三个循环结构的用处和基本模板与思路。

### 规定个数的循环结构

在第一章中，我们循环部分的第一道练习题就是求和运算。在求和运算中，我们规定了数列中元素的个数$n$，即一共有$n$个数参与运算，想必在这个题目中，大家都不约而同的想到了`for`语句实现，在此之前，我们简单回顾一下`for`语句的语法与语义。



#### for语句的语法与语义

```c++
for (i=1; i<=n; i++){ //C++语言
	cin >> a;
    sum += a;
}
for (i=1; i<=n; i++){ //C语言
	scanf("%d",&a);
    sum += a;
}
```

以上是在求和题目中最主要的循环部分，仔细观察，发现for语句其实是由三个表达式和一个循环体构成，在`()`中，三个表达式之间以分号`;`隔开，不同的表达式之间有不同的含义。如果我们用while结构来改写上述代码，那就是：

```c++
i = 1;
while(i<=n){
	//循环体
	i++;
}
```

显然我们可以看出，for语句比while更简洁，更易懂，是极大地方便了我们程序员的操作。

在for语句中，三个表达式都拥有以下的含义：

- 表达式一：通常是循环前的准备，初始条件，在循环开始之前执行，此后不再执行；
- 表达式二：循环进行的条件，每次执行循环体前判断逻辑表达式的真假，如为真继续执行，这里就和while结构的逻辑表达式的语义是一样的；
- 表达式三：为下一次循环做的准备，在判断条件之间，执行此语句，为下一次循环准备。

总体而言，for语句的执行流程可以是：

```
表达式1 -> 表达式2 -> 循环体 -> 表达式3 -> 表达式2 -> 循环体 -> 表达式3 -> ...
... -> 表达式2（假） -> 循环结束
```

需要**注意**的是：表达式1,2,3**可以为空语句，但不可以省略不写**，也就是说，即使不需要其中的一个表达式，你仍然需要把分号`;`加上，比如`for(;i<=n;)`。（表达式1、3是空语句）



分析for语句的特点可以看出，for循环最大的用处就是计算循环次数，完成规定个数循环结构。因为for语句相比较while而言，有**第三个表达式**，这个表达式在这里就是方便我们对循环次数进行计数，使其与循环体独立开来，保证了程序的可读性和易懂性。



就是有了第三个表达式，我们就可以用这个特性来限定循环执行的次数，比如：

```c++
for(int i = 0; i < 3; i++){
	//loops
}
```

上面这个for循环，只要循环体中不改变循环变量i的值，这个循环一定会执行3次，不多不少，正正好好。只要改变第二个表达式中的常量`3`，就可以任意改变循环执行的次数，也可以改为某个变量来实现某些特定的要求。具体的我们在下一个部分着重探讨。

#### 使用for循环解决规定个数循环问题

首先，我们需要从题目中识别**规定个数循环问题**的特征（满足其中一些条件即可，还有一些没有满足下面条件但是隐含个数问题的都算在其中）：

1. 题目中的输入格式中，会有一行输入一个正整数，表示下面数据组的输入个数；
2. 题目中有明显的对数量的规定或隐含规定（比如一年有12个月等等）；
3. 问题输出的结果，在处理方式上不依赖与对已处理数据的访问。（如果不满足这一点，即，题目要求处理批量数据，则需要用到下一节我们要探讨的**数组**）

前两点很好理解，第三点这里给出一个说明：比如在求和问题中，我们在循环体中输入该数，把它加到求和变量中后，后面数据的处理就不需要用到这个数的值了。其他的问题特征比如找出最大最小数，计算平均值等，都满足这个性质。这个得视具体情况而定。比如在上一章的第14题中，如果Asriel的身高在果实高度之前输入，我们就可以对比果实高度和身高进行分析，化简为求和与比较大小等基本数据处理，处理完毕后，果实高度就不需要再使用了。但如果身高在果实高度之后输入，此题就不能用这个方法去做了。

处理这类问题，我们就要用for循环做个数约束，此时我们需要引入**循环变量**。循环变量就是上面例子中的变量`i`，在循环开始前初始化为1（有时候初始化为0），每次循环后+1，准备下一次循环，只有在循环变量`i`小于规定循环个数时，循环才能继续，一定次数后，跳出循环。

在循环体中，主要操作就是输入，处理。处理遵循数据处理的普遍特征，这里给出两个最最基本的处理方式：求和与比较。

```c++
//求和
int ans = 0; //初始化
for(i = 1; i <= n; i++){
	cin >> a;//C语言是 scanf("%d",&a);
	ans += a;
}
//此时ans就为最终的求和结果
```

```c++
//比较（取最大数）
int max = 0; //初始化，这里初始化的值可以是比数据规模小的任意数。
for (i = 1; i <= n; i++){
	cin >> a;//C语言是 scanf("%d",&a);
	if (a > max) max = a;
}
//此时max就为最终最大数结果
```

事实上，很多的题目都是这两种处理方式的变式，这里不再赘述，希望读者能够自行总结。



### 与整数位数有关的循环结构

在第一章中，有一道题目要求使用循环结构，来判断输入整数$n$的位数，在一些设计数的性质方面的题目，我们也经常要对变量的每一位数分别做处理。涉及到**整数位数**的题目，其实都可以运用我们在这里提出的思想尝试解决。

首先，我们来看一下C/C++中提供的对于整数操作的两个重要的运算符：**`/`除与`%`取余数**。

#### 运算符'/'与'%'

在C/C++中，运算符`/`对两个整数进行操作时，结果依然是整数，如果无法除尽，则**舍弃余数，结果绝对值向下取整**，这也是很多编程新手较为困惑的地方，但是在没有完全了解机器运算原理之前，这样的结论暂且记住就好。

值得一提的是，如果要让整数除法的结果保留其小数，要作**强制类型转换**，新手题库不会对此类概念作过多解说，但是这个地方是新手较容易出错的地方，比如对int型数n，`n/3`和`n/3.0`的结果往往是不一样的，关于这部分我们就不再详细说明了。

还有一个运算符`%`模运算，也很好理解，它与`/`配合起来用就能作我们小学学过的**带余除法**，由此解决一些和整数命题相关的题目，事实上，我们已经渐渐习惯用`%`运算符解决一些问题，比如用`n%2==0`来判断n是否是偶数等等。

综合运用`/`和`%`运算符，我们能对一个整数作一些很**funny**的事情，比如：取它的每一位。

我们可以意识到，一个正整数n，如果对他作**除以10的带余除法**，我们就可以将这个数分成两个部分：商是原来的数砍掉了个位数之后形成的新数$n_1$，余数就是原数n的个位数了，按照这个方法，我们就成功提取了n的个位数字$a_0$，如果我们对$n_1$也做一次除以10的带余除法，发现我们又成功提取了$n_1$的个位数字，即$n$的个位数字$a_1$。

讲到这里大家都明白了吧，其实我们把提取各位数字的过程，通过数学上的带余除法将其解决了下来。所以，接下来要讲的**有关整数位数的循环结构**，其作用原理就是带余除法。

#### 用带余除法解决整数位数问题

很显然，上一章求整数位数的问题，我们可以用不断除以10舍弃个位数的方式来计算位数，但是，对于一个完整的算法，我们依旧需要考虑：

> **循环结束的条件是什么？**
>
> **循环体如何处理数据？**
>
> **如何存储循环体中产生的新数据？**

我们现在以一道例题来说明这部分内容：

> 例：对于一个正整数n，将其倒序输出。

按照上面的思想，我们的想法就变得容易的多：只需要每次获取其个位数，输出后，扔掉就行了。

有关循环结束的条件，试想一下，当n变成一个个位数时，再让它作除10的带余除法，最后的商变成了0，而余数就是它本身，这个商`0`，显然就可以作为一个完美的循环结束条件（即除10除到商为0，结束循环），有了这些分析，我们讨论以下代码框架：

```c++
while(n!=0){
	int r = n%10; //r就是n的个位数
	n /= 10; //n = n/10; 将n的个位数舍弃
	cout << r; //printf("%d",r); 输出个位数字r
}
```

按照这个框架，我们对n先取余数，再舍余数，这就是我们的整个思路，在循环代码中加入计数变量，每次循环变量值+1，就可以得到这个数的位数了。

**带余除法**的循环结构思想也可以用于其他的问题求解，比如**辗转相除法求最大公因数**。

根据定理`gcd(m, n) == gcd(n, m mod n)`，只需要算出`m%n`的值，然后用n和算出来的新值继续做带余除法，除到最后两数能互相整除，较小的那个数就是m和n的最大公因数了，这里面不但包含了带余除法的思想，也有**迭代**相关的思想，我们下一节将讨论循环与迭代的结构。

### 循环与迭代结构

迭代，顾名思义，用新值替换旧值。在对某些特定函数值进行计算的时候，当我们计算出其前几项时，我们就可以利用**递推关系**来算出后面的函数项的值。数学归纳法的证明思想也依赖于前后项的递推关系。于是当我们找到这个递推关系，我们理论上就可以利用前项计算出后项，从而得到特定的函数值。

#### 递推关系

递推关系一般指前后项的关系，这一般依赖于一个函数来讨论，最典型的函数就是**斐波那契数列（Fibonacci sequence）**。

斐波那契数列的递推关系式如下所示：
$$
f(x) = \begin{cases}1& \text{x=1 or x=2}\\\\f(x-1)+f(x-2)& \text{x>=3}\end {cases}
$$

第一行是递推基础，有了前面有限函数项的值，我们就可以顺次一个一个解出后面各项的值。

这时候假设我们要求$f(5)$，我们就会考虑先去求$f(3)$和$f(4)$，然后利用$f(5)=f(3)+f(4)$解出对应的函数值。

而我们在求解$f(4)$时，由于只需要用到$f(2)$和$f(3)$，$f(1)$的值就可以扔掉，同样求解$f(5)$时也不需要用到$f(2)$的值了，因此，整个求解过程，无论最后求解哪一项，我们都只需要存储两项函数值，在求出新值时进行**迭代**处理，将最老的一个值剔除，将最新生成的一个值加入就可以了。

#### 递推关系的循环结构

如果用递推关系来解决斐波那契数列问题，我们可以只开两个存储变量a, b，算出新值c后，用b,c的值代替a,b的值，然后继续运用新a,b的值进行计算。

于是，求第n项的代码可以写成：

```c++
long long a=1, b=1, c;
for(int i = 3; i <= n; i++){
	c = a+b; //按照递推关系计算出新值；
	a = b;
	b = c;  //迭代替换a,b的值
}//循环结束后，c(b)即为最终结果
```

请自行理解循环代码，体味其中变量交♂互的过程。

在数学上，我们通常会用**迭代法**解决一系列问题，比如通过构造一个数列$a_n$，我们可以证明数列$a_n$的极限就是我们要求的数值，为了得到数列$a_n$最终收敛的结果，我们也可以用迭代的方法解决。

我们知道，对于收敛数列$a_n$，如果n不断变大，它的函数值变化幅度会越来越小，最终趋于一个特定的数值。在利用计算机解题时，我们就可以通过$a_n$的递推表达式，不断算出新的函数值$a _ {i+1}$，然后再与它算到的旧值$a_i$比较，如果两数差很小，小到只有$10^-6$这样的数量级（或更小），我们就可以直接将$a _ {i+1}$的值看做$a_n$的极限。

用伪代码阐释，就是：

```c++
double a=<某个初值>, b=<某个初值>;
while(|a-b|<EPS) {//EPS是一个很小的数，比如1e-6
	a = b; //让a迭代为上一个计算出来的新值b
	b = ...a...; //利用递推关系，用新的a计算新值b
}
```

对于迭代方法，具体题目还要具体分析。

## 本章题目

### 编程题

本章我们选择了10道与**循环结构**有关的题目，请自行根据题面信息，选取适当的循环结构自行解决。

**注意：请点击“题目列表”查看课后习题，并在“排行榜”中查看你的题目得分情况。课后习题评测采用洛谷官方评测机，所使用的测试用例为本地生成，测试用例与课后习题的参考答案，请在新手题库2020主页查看。**

